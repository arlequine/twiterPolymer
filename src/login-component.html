<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-icons/communication-icons.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">

<dom-module id="login-component">
  <template>
    <style>
    :root {
      --card-color-main: #68cbcb;
      --text-color-main: #ffffff;
      --login-color: #072146;
      --main-color: #5bbeff;
      /* Input foreground color */
      --paper-input-container-input-color: #fff;
      width: 80%;
      margin: 0 auto;
    }
    form {
      width: 80%;
      margin: 0 auto;
    }
    paper-button {
      background-color: #2dcdcd;
    }
    .--paper-input-container-input-color {
      color: #ffffff !important;
    }
    .container {
      display: flex;
      grid-template-columns: 1fr 1fr;
      margin: 0 auto;
      width: 80%;
      flex-direction: row;
      justify-content: center;
      text-align:center;
    }
    .card {
      background-color: var(--card-color-main);
      position: relative;
      color: var(--text-color-main);
    }
    .login-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      background-color: var(--login-color);
      position: relative;
      color: var(--text-color-main);
      width: 50%;
    }
    </style>
    <div class="container">
      <div class="card">
        <h2>Rgistrate Hoy</h2>
        <iron-image src="/img/navesita02.png" alt="navesita" style="width:500px; height:600px;" sizing="contain"></iron-image>
      </div>
      <div class="login-content">
        <h1>Sign In</h1>
        <div class="login">
          <form is="iron-form" id="formLogin" method="post" action="/form/handler">
            <form class="">
              <paper-input class="input-login" auto-validate pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" value='{{email}}' label="email" required>
                <label for="input-login">Email</label>
                <iron-icon icon="mail" slot="prefix"></iron-icon>
              </paper-input>
              <paper-input class="input-login" value='{{password}}' type="password" label="Password" required>
                <label for="input-login">Password</label>
                <iron-icon icon="icons:lock" slot="prefix"></iron-icon>
              </paper-input>
              <paper-button raised on-click="submit">
                Login<iron-icon icon="icons:arrow-forward"></iron-icon>
              </paper-button>
            </form>
          </form>
        </div>
      </div>
    </div>
      <iron-ajax
      id="submitLogin"
      url="https://posts-services.herokuapp.com/login"
      method="POST"
      body='{{bodyPost}}'
      handle-as="json"
      on-response="handleResponse"
      debounce-duration="300"
      loading=""
      ></iron-ajax>
  </template>
  <script>
    (function loginComponent(customElements) {
      'use strict';
      class LoginComponent extends Polymer.Element {
        static get is() {return 'login-component'};
        static get properties() {
          return {
            prop: String,
            bodyPost: {
              type: Object,
              computed: 'getBodyPost(email, password)'
            },
            route: {
              type: Object,
              notify: true
            },
            session: {
              type: Boolean,
              notify: true
            }
          }
        }
        getBodyPost(email, password) {
          return { 'email': email, 'password': password }
        }
        handleResponse(response) {
          if (response) {
            setTimeout(() =>{
              this.set('session', true);
              localStorage.email = this.email;
              this.set('route.page', 'posts');
            }, 3000)
          }
        }
        submit(event) {
          console.log('------');
          this.handleResponse(true);
        }
      }
      customElements.define(LoginComponent.is, LoginComponent);
    })(window.customElements);
  </script>
</dom-module>
